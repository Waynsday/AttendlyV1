# AttendlyV1 - School Attendance Recovery System
# Environment Variables Configuration
# 
# CRITICAL: This file contains examples only. 
# Copy to .env.local and fill in your actual values.
# NEVER commit actual secrets to version control.

# =============================================================================
# NEXT.JS CONFIGURATION
# =============================================================================
NEXTAUTH_URL=http://localhost:3000
NEXTAUTH_SECRET=your-secret-key-here-generate-with-openssl-rand-base64-32
NODE_ENV=development

# =============================================================================
# SUPABASE CONFIGURATION
# =============================================================================
# Get these from: https://supabase.com/dashboard/project/YOUR_PROJECT/settings/api
NEXT_PUBLIC_SUPABASE_URL=https://your-project.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=your-anon-key-here
SUPABASE_SERVICE_ROLE_KEY=your-service-role-key-here

# Database URL for migrations (optional - CLI uses project settings)
DATABASE_URL=postgresql://postgres:password@db.your-project.supabase.co:5432/postgres

# =============================================================================
# AERIES SIS INTEGRATION (Romoland School District)
# =============================================================================
# Contact: Vince Butler (CTO) for API credentials
AERIES_API_URL=https://aeries.romoland.k12.ca.us/api
AERIES_API_KEY=your-aeries-api-key-here
AERIES_CLIENT_ID=your-aeries-client-id
AERIES_CLIENT_SECRET=your-aeries-client-secret

# Aeries OAuth Configuration
AERIES_OAUTH_URL=https://aeries.romoland.k12.ca.us/oauth
AERIES_REDIRECT_URI=https://your-domain.com/api/auth/aeries/callback

# =============================================================================
# IREADY INTEGRATION
# =============================================================================
# Contact: District IT for SFTP credentials
IREADY_SFTP_HOST=sftp.iready.com
IREADY_SFTP_USERNAME=romoland_district
IREADY_SFTP_PASSWORD=your-sftp-password
IREADY_SFTP_PORT=22

# iReady data processing settings
IREADY_DATA_PATH=/data/uploads/iready
IREADY_SYNC_SCHEDULE=0 2 * * * # Daily at 2 AM

# =============================================================================
# SCHOOL STATUS ATTEND (A2A) INTEGRATION
# =============================================================================
# Contact: Matthew Valdivia (Director of Pupil Services)
A2A_API_URL=https://schoolstatusattend.com/api
A2A_API_KEY=your-a2a-api-key
A2A_DISTRICT_ID=romoland-usd

# CSV Upload settings (temporary until API available)
A2A_CSV_UPLOAD_PATH=/data/uploads/a2a
A2A_PROCESSING_SCHEDULE=0 8 * * 1 # Every Monday at 8 AM

# =============================================================================
# SECURITY & COMPLIANCE
# =============================================================================
# FERPA Compliance Settings
FERPA_COMPLIANCE_MODE=enabled
AUDIT_LOG_RETENTION_DAYS=2555 # 7 years as required by FERPA
STUDENT_DATA_ENCRYPTION_KEY=your-encryption-key-here-32-chars

# Rate Limiting (per minute)
RATE_LIMIT_PER_USER=100
RATE_LIMIT_PER_IP=200
RATE_LIMIT_ADMIN_BYPASS=true

# Session Management
SESSION_TIMEOUT_HOURS=4
MAX_CONCURRENT_SESSIONS=3
SESSION_HIJACK_DETECTION=enabled

# =============================================================================
# MONITORING & OBSERVABILITY
# =============================================================================
# Sentry for error tracking
SENTRY_DSN=your-sentry-dsn-here
SENTRY_ENVIRONMENT=development

# Log Level
LOG_LEVEL=info
AUDIT_LOG_LEVEL=debug

# Health Check Configuration
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_INTERVAL_MINUTES=5

# =============================================================================
# EMAIL NOTIFICATIONS
# =============================================================================
# For parent communications and system alerts
SMTP_HOST=smtp.romoland.k12.ca.us
SMTP_PORT=587
SMTP_USER=attendly@romoland.k12.ca.us
SMTP_PASSWORD=your-smtp-password
SMTP_FROM=AttendlyV1 System <attendly@romoland.k12.ca.us>

# =============================================================================
# CALIFORNIA COMPLIANCE (SB 153/176)
# =============================================================================
# Settings for California attendance recovery legislation
CA_ATTENDANCE_RECOVERY_ENABLED=true
CA_ADA_FUNDING_CALCULATION=enabled
CA_CHRONIC_ABSENTEEISM_THRESHOLD=0.10 # 10%
CA_RECOVERY_SESSION_RATIO=4 # 4 hours = 1 day recovered

# Tier definitions
TIER_1_THRESHOLD=2 # 1-2 days absent
TIER_2_THRESHOLD=9 # 3-9 days absent  
TIER_3_THRESHOLD=10 # >10% chronically absent

# =============================================================================
# DEVELOPMENT SETTINGS
# =============================================================================
# Only used in development environment
DEV_SKIP_AUTH=false
DEV_MOCK_DATA=false
DEV_API_DELAY_MS=0

# Test database (for automated testing)
TEST_DATABASE_URL=postgresql://postgres:password@localhost:54322/postgres

# =============================================================================
# MANUAL SETUP INSTRUCTIONS
# =============================================================================
# 
# CLI Method (if available):
# 1. gh secret set SUPABASE_SERVICE_ROLE_KEY
# 2. gh secret set AERIES_API_KEY
# 3. gh secret set NEXTAUTH_SECRET
# 
# Manual Method:
# 1. Go to GitHub repository Settings → Secrets and variables → Actions
# 2. Click "New repository secret"
# 3. Add each secret with corresponding value
# 4. For local development, copy this file to .env.local
# 5. Fill in actual values (never commit .env.local)
# 
# Supabase Setup:
# CLI: supabase init && supabase start
# Manual: Create project at https://supabase.com/dashboard
# 
# Database Migrations:
# CLI: supabase db push
# Manual: Copy SQL from supabase/migrations/*.sql to SQL Editor in dashboard